"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.hasYarn = exports.yarnOrNpmSpawn = exports.safeYarnOrNpm = void 0;
const cross_spawn_promise_1 = require("@malept/cross-spawn-promise");
const chalk_1 = __importDefault(require("chalk"));
const detect_package_manager_1 = require("detect-package-manager");
const log_symbols_1 = __importDefault(require("log-symbols"));
const safeYarnOrNpm = async () => {
    const system = await (0, detect_package_manager_1.detect)();
    switch (process.env.NODE_INSTALLER) {
        case 'yarn':
        case 'npm':
            return process.env.NODE_INSTALLER;
        default:
            if (process.env.NODE_INSTALLER) {
                console.warn(log_symbols_1.default.warning, chalk_1.default.yellow(`Unknown NODE_INSTALLER, using detected installer ${system}`));
            }
            return system;
    }
};
exports.safeYarnOrNpm = safeYarnOrNpm;
const yarnOrNpmSpawn = async (args, opts) => (0, cross_spawn_promise_1.spawn)(await (0, exports.safeYarnOrNpm)(), args, opts);
exports.yarnOrNpmSpawn = yarnOrNpmSpawn;
const hasYarn = async () => (await (0, exports.safeYarnOrNpm)()) === 'yarn';
exports.hasYarn = hasYarn;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoieWFybi1vci1ucG0uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMveWFybi1vci1ucG0udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEscUVBQXVGO0FBQ3ZGLGtEQUEwQjtBQUMxQixtRUFBZ0Q7QUFDaEQsOERBQXFDO0FBRTlCLE1BQU0sYUFBYSxHQUFHLEtBQUssSUFBSSxFQUFFO0lBQ3RDLE1BQU0sTUFBTSxHQUFHLE1BQU0sSUFBQSwrQkFBTSxHQUFFLENBQUM7SUFDOUIsUUFBUSxPQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBQ25DLEtBQUssTUFBTSxDQUFDO1FBQ1osS0FBSyxLQUFLO1lBQ1IsT0FBTyxPQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsQ0FBQztRQUNwQztZQUNFLElBQUksT0FBTyxDQUFDLEdBQUcsQ0FBQyxjQUFjLEVBQUUsQ0FBQztnQkFDL0IsT0FBTyxDQUFDLElBQUksQ0FBQyxxQkFBVSxDQUFDLE9BQU8sRUFBRSxlQUFLLENBQUMsTUFBTSxDQUFDLG9EQUFvRCxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDL0csQ0FBQztZQUNELE9BQU8sTUFBTSxDQUFDO0lBQ2xCLENBQUM7QUFDSCxDQUFDLENBQUM7QUFaVyxRQUFBLGFBQWEsaUJBWXhCO0FBRUssTUFBTSxjQUFjLEdBQUcsS0FBSyxFQUFFLElBQXFCLEVBQUUsSUFBd0IsRUFBbUIsRUFBRSxDQUFDLElBQUEsMkJBQUssRUFBQyxNQUFNLElBQUEscUJBQWEsR0FBRSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztBQUF0SSxRQUFBLGNBQWMsa0JBQXdIO0FBRTVJLE1BQU0sT0FBTyxHQUFHLEtBQUssSUFBSSxFQUFFLENBQUMsQ0FBQyxNQUFNLElBQUEscUJBQWEsR0FBRSxDQUFDLEtBQUssTUFBTSxDQUFDO0FBQXpELFFBQUEsT0FBTyxXQUFrRCJ9